<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ref√∫gio Digital de Livros</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
</head>
<body class="font-serif bg-gray-50">

  <custom-navbar></custom-navbar>

  <main class="container mx-auto px-4 py-8 max-w-6xl">

    <!-- Header -->
    <header class="mb-12 text-center">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">Ref√∫gio Digital de Livros</h1>
      <p class="text-gray-600 max-w-2xl mx-auto">Descubra livros digitais belamente elaborados com uma experi√™ncia de leitura imersiva</p>
    </header>

    <!-- Livros em Destaque -->
    <section class="mb-16">
      <h2 class="text-2xl font-semibold text-gray-800 mb-6">Livros em Destaque</h2>
      <div id="book-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
        <!-- Livros carregados via JS -->
      </div>
    </section>

    <!-- Cap√≠tulos Recentes -->
    <section class="mb-16">
      <h2 class="text-2xl font-semibold text-gray-800 mb-6">Cap√≠tulos Recentes</h2>
      <div id="chapters" class="flex overflow-x-auto space-x-6">
        <!-- Cap√≠tulos carregados via JS -->
      </div>
    </section>

  </main>

  <custom-footer></custom-footer>

  <script src="components/navbar.js"></script>
  <script src="components/footer.js"></script>
  <script>
    feather.replace();

    const bookList = document.getElementById('book-list');
    const chaptersDiv = document.getElementById('chapters');

    fetch('/livros.json')
      .then(res => res.json())
      .then(livros => {
        // üìö Livros em destaque
        livros.forEach(l => {
          const div = document.createElement('div');
          div.className = 'book-card';
          div.innerHTML = `
            <img src="${l.coverImage || 'https://placehold.co/200x300'}" alt="${l.title}" />
            <h3>${l.title}</h3>
            <p>${l.author}</p>
            <a href="reader.html?id=${l.id}" class="text-indigo-600 hover:underline mt-auto">Ler</a>
          `;
          bookList.appendChild(div);
        });

        // üìñ √öltimos cap√≠tulos
        let allChapters = [];
        livros.forEach(l => {
          l.chapters.forEach(c => allChapters.push({
            bookId: l.id,
            bookTitle: l.title,
            chapterId: c.id,
            title: c.title,
            createdAt: c.createdAt || l.createdAt
          }));
        });

        allChapters.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
        allChapters.slice(0, 5).forEach(c => {
          const div = document.createElement('div');
          div.className = 'chapter-card min-w-[220px] flex flex-col';
          div.innerHTML = `
            <h4 class="font-semibold mb-1">${c.title}</h4>
            <p class="text-gray-600 text-sm mb-2">de ${c.bookTitle}</p>
            <a href="reader.html?id=${c.bookId}&cap=${c.chapterId}" class="text-indigo-600 hover:underline mt-auto">Ler cap√≠tulo</a>
          `;
          chaptersDiv.appendChild(div);
        });
      })
      .catch(err => console.error('Erro ao carregar dados:', err));
  </script>
</body>
</html>